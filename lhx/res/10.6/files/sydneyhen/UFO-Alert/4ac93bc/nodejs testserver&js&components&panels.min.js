!function(t,n,e,i){"use strict";function a(){var t=n.querySelector(".app-active");if(null!==t.querySelector("div.backdrop-panel")){var i=s[s.length-1].backdrop;i.classList.remove("fadeout"),t.removeChild(i)}s[s.length-1].panel.style.visibility="visible",l=!1,s.pop(),this.off(e.event.transitionEnd,a,!1)}function o(t){if(!l&&(t.style.visibility="visible",!t.classList.contains("active"))){t.classList.add("active");var e=e=c();n.querySelector(".app-active").appendChild(e),s.push({panel:t,backdrop:e})}}function r(t){if(!l&&t.classList.contains("active")&&!l){l=!0,t.classList.remove("active"),t.classList.add("panel-closing");var n=function(){t.classList.remove("panel-closing"),t.off(e.event.transitionEnd,n)};if(t.on(e.event.transitionEnd,n),s.length>0){var i=s[s.length-1].backdrop;i.classList.add("fadeout"),i.on(e.event.transitionEnd,a,!1)}}}var s=[],l=!1,c=function(){var t=n.createElement("div");return t.classList.add("backdrop-panel"),t},f=function(t){for(var e,i=n.querySelectorAll("[data-panel-id], [data-panel-close]");t&&t!==n;t=t.parentNode)for(e=i.length;e--;)if(i[e]===t)return t},d=function(t){var e=f(t.target);if(e){var i=e.getAttribute("data-panel-id");return i?n.querySelector("#"+i):p(t.target)}},p=function(t){for(var e,i=n.querySelectorAll(".panel, .panel-full");t&&t!==n;t=t.parentNode)for(e=i.length;e--;)if(i[e]===t&&t.classList.contains("active"))return t},u=function(t){for(;t&&t!==n;t=t.parentNode)if(t.classList.contains("dialog")||t.classList.contains("backdrop-dialog"))return!0;return!1};n.on(e.event.start,function(t){if(t=t.originalEvent||t,!(t.target.classList.contains("notification")||t.parentNode&&t.target.parentNode.classList.contains("notification"))&&!u(t.target)&&s.length>0){var n=s[s.length-1].panel,e=p(t.target);e||r(n),e&&e!==n&&e.id!==n.id&&r(n)}}),n.on(e.event.tap,function(t){if(!(t.target.classList.contains("notification")||t.parentNode&&t.target.parentNode.classList.contains("notification")||u(t.target))){var n=f(t.target),e=null;if(n&&(e=d(t),e&&(e.classList.contains("active")?r(e):o(e))),e=p(t.target),!e&&!n&&s.length>0){var i=s[s.length-1].panel;p(t.target);r(i)}}}),e.panel=function(t){if("undefined"==typeof t)return{closeActive:function(){var t=s.length>0?!0:!1;return t&&r(s[s.length-1].panel),t}};var e="string"==typeof t?n.querySelector(t):t;if(null===e)throw new Error("The panel with ID "+t+" does not exist");return{open:function(){o(e)},close:function(){r(e)}}},t.phonon=e,"object"==typeof exports?module.exports=e.panel:"function"==typeof define&&define.amd&&define(function(){return e.panel})}(window,document,window.phonon||{});