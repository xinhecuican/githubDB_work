# 01开闭原则

### （1）概念

​	**开闭原则的定义是：软件实体（类、模块、方法）应该对扩展开发，对修改关闭。（所有原则的基础）**
​	**即当软件需要变化时，尽量通过扩展软件实体的行为来实现变化，而不是通过修改已有的代码来实现变化（用抽象构建框架，用实现扩展细节）。**
​	**优点：提高软件系统的可复用性及可维护性。**

### （2）举例

​	**书店刚开始卖小说类书籍，后来要求小说类书籍打折处理（40元以上9折，其他8折），再后来书店增卖计算机类书籍（比小说类书籍多一个属性“类别”）。**

​	**书店刚开始卖小说类书籍的类图如下：** 

- ​	![开闭原则图](https://raw.github.com/LGSKOKO/SoftwareEngineering/master/设计模式/img/开闭原则图1.png)


​	**后来要求小说类书籍打折处理（40元以上9折，其他8折）**

​	如果通过修改接口，在接口上新增加一个方法getOffPrice()专门来处理打折书籍，所有实现类实现该方法。那么与IBook接口相关的类都需要修改。而且作为接口应该是稳定且可靠的，不应经常变化，否则接口作为契约的作用就失去效能了。因此，此方案行不通。
​	如果修改实现类NovelBook中的方法，直接在getPrice()中实现打折处理，也可以达到预期效果。但采购人员看到的价格是打折后的价格，而看不到原来的价格。
​	**综上，按照开闭原则，应该通过扩展实现变化，增加一个子类OffNovelBook，重写getPrice()方法实现打折处理。改进后的类图如下：**

- ​	![开闭原则图](https://raw.github.com/LGSKOKO/SoftwareEngineering/master/设计模式/img/开闭原则图2.png)


​	**再后来书店增卖计算机类书籍（比小说类书籍多一个属性“类别”），增加一个IComputerBook接口继承IBook接口，增加一个ComputerBook类实现IComputerBook接口即可，其类图如下：**

- ​	![开闭原则图](https://raw.github.com/LGSKOKO/SoftwareEngineering/master/设计模式/img/开闭原则图3.png)

### （3）总结

- **开闭原则是面向对象设计中“可复用设计”的基石。**
- **开闭原则是面向对象设计的终极目标，其他原则可以看做是开闭原则的实现方法。**
- **在业务规则改变的情况下，高层模块必须有部分改变以适应新业务，但这种改变是很少的，也防止了变化风险的扩散。**