# 04原子性

## 目录

- **什么是原子性？**
- **Java中原子操作有哪些？**
- **long 和 double 的原子性**
- **原子操作+原子操作!=原子操作**

------

## 什么是原子性？

- **一系列的操作，要么全部执行成功，要么全部不执行，不会出现执行一半的情况，是不可分割的。**

## Java中原子操作有哪些？

- **1）除long和double之外的基本类型（int, byte, boolean, short, char, float）的赋值操作。**
- **2）所有引用reference的赋值操作，不管是 32 位的机器还是 64 位的机器。**
- **3）java.concurrent.Atomic.* 包中所有类的原子操作**

## **long 和 double 的原子性**

-  **对于64位的long和double，如果没有被volatile修饰，那么对其操作可以不是原子的。在操作的时候，可以分成两步，每次对32位操作。** 
- **如果使用volatile修饰long和double，那么其读写都是原子操作** 
- **在32位上的JVM上，long 和 double的操作不是原子的，但是在64位的JVM上是原子的。**

## 原子操作+原子操作 != 原子操作

- 如 a++问题：a++ 分为两步：  一、读取a  二、a=a+1； 这两步都分别是原子操作 但组合在一起并不是原子操作。
- 去ATM机两次取钱是两次独立的原子操作，但是期间有可能银行卡被借给女朋友，也就是被其他线程打断并被修改。